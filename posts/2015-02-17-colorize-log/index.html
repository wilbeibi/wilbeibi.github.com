<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Colorizing Loggers -- A simple practice of decorator - Gradient Ascent</title><meta name=description content="colorize text, use dictionary as switch case, decorator with parameters"><meta property="og:title" content="Colorizing Loggers -- A simple practice of decorator"><meta property="og:description" content="colorize text, use dictionary as switch case, decorator with parameters"><meta property="og:type" content="article"><meta property="og:url" content="https://wilbeibi.com/posts/2015-02-17-colorize-log/"><meta property="og:site_name" content="Gradient Ascent"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2015-02-18T00:00:00Z"><meta property="article:modified_time" content="2026-02-16T16:16:06-08:00"><meta property="article:author" content="wilbeibi"><meta property="article:tag" content="python"><meta name=twitter:card content="summary"><meta name=twitter:title content="Colorizing Loggers -- A simple practice of decorator"><meta name=twitter:description content="colorize text, use dictionary as switch case, decorator with parameters"><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel="shortcut icon" href=/favicon.ico><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,400;0,700;1,400;1,700&family=JetBrains+Mono:wght@400;700&display=swap" rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/style.css rel=stylesheet><link rel=canonical href=https://wilbeibi.com/posts/2015-02-17-colorize-log/><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","headline":"\"Colorizing Loggers -- A simple practice of decorator\"","description":"\"colorize text, use dictionary as switch case, decorator with parameters\"","datePublished":"2015-02-18T00:00:00Z","dateModified":"2026-02-16T16:16:06-08:00","author":{"@type":"Person","name":"\"wilbeibi\"","url":"https:\/\/wilbeibi.com\/"},"publisher":{"@type":"Person","name":"\"wilbeibi\""},"mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/wilbeibi.com\/posts\/2015-02-17-colorize-log\/"},"keywords":"[\"python\"]"}</script></head><body><div class=container><div class=header><a href=/>wilbeibi</a>'s Gradient Ascent</div><div class=navigation><ul><li><a href=/>Home</a></li><li><a href=/posts/>Archive</a></li><li><a href=/tags/>Tags</a></li><li><a href=/pages/about/>About</a></li></ul></div><div class=body><h1>Colorizing Loggers -- A simple practice of decorator</h1><p class=date>written on February 18, 2015 Â· 3 min read</p><h2 id=what-is-this-post-about>What is this post about</h2><p>Many people believe that decorator is one of the obscure concepts in Python.
Trust me, it is not. To be short, <strong>a decorator is a function that modifies other
functions via closures.</strong></p><p>They are plenty detailed articles about what decorator it is so there is no need to write one more. If you are not familiar with it, you may want to check these:</p><ul><li><p><a href=http://sahandsaba.com/python-decorators.html>A Study of Python&rsquo;s More Advanced Features Part II: Closures, Decorators and functools</a></p></li><li><p><a href=https://realpython.com/blog/python/primer-on-python-decorators/#.UvQEs0JdUwJ>Primer on Python Decorators</a></p></li></ul><p>In this article, I am going to use a simple but interesting example to show</p><ul><li>how to colorize the output in command line</li><li>how to implement a switch case in Python (Python does not have built-in switch case)</li><li>a decorator with parameters</li></ul><p>OK, let&rsquo;s rock.</p><h2 id=colorize-your-text>colorize your text</h2><p>There is a set of escape sequences used to change the color of texts. So if we want to colorize a sentence, we just need to put the sentence between the color escape sequence and reset escape sequence. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#0550ae>&gt;&gt;</span> ORANGE <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[33m&#39;</span>
</span></span><span style=display:flex><span><span style=color:#0550ae>&gt;&gt;</span> RED <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[31m&#39;</span>
</span></span><span style=display:flex><span><span style=color:#0550ae>&gt;&gt;</span> GREEN <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[32m&#39;</span>
</span></span><span style=display:flex><span><span style=color:#0550ae>&gt;&gt;</span> BLUE <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[34m&#39;</span>
</span></span><span style=display:flex><span><span style=color:#0550ae>&gt;&gt;</span> RESET <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[0m&#39;</span>
</span></span><span style=display:flex><span><span style=color:#0550ae>&gt;&gt;</span> <span style=color:#6639ba>print</span> ORANGE <span style=color:#0550ae>+</span> <span style=color:#0a3069>&#34;Chinese New Year&#34;</span> <span style=color:#0550ae>+</span> RESET
</span></span><span style=display:flex><span><span style=color:#0550ae>&gt;&gt;</span> <span style=color:#6639ba>print</span> GREEN <span style=color:#0550ae>+</span> <span style=color:#0a3069>&#34;Chinese&#34;</span> <span style=color:#0550ae>+</span> GREEN <span style=color:#0550ae>+</span> <span style=color:#0a3069>&#34;New&#34;</span> <span style=color:#0550ae>+</span> BLUE <span style=color:#0550ae>+</span> <span style=color:#0a3069>&#34;Year&#34;</span> <span style=color:#0550ae>+</span> RESET
</span></span></code></pre></div><p>You will see
<font style=font-family:courier color=orange>Chinese New Year</font></p><p>and
<font style=font-family:courier color=red>Chinese </font><font style=font-family:courier color=green>New </font><font style=font-family:courier color=blue>Year</font></p><h2 id=how-to-choose-the-color-in-code>How to choose the color in code</h2><p>As I said, Python does not support switch case. So we cannot switch the color name and choose the corresponding escaped sequence. Fortunately, dictionary would do the work.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#cf222e>def</span> <span style=color:#6639ba>getColor</span><span style=color:#1f2328>(</span>color<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>    <span style=color:#57606a># @param color: string like &#34;red&#34; or &#34;yellow&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#57606a># @return the corresponding escape sequence.</span>
</span></span><span style=display:flex><span>    <span style=color:#57606a># If not valid, return empty string</span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>return</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>    RED <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[31m&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>    GREEN <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[32m&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>    BLUE <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[34m&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>    <span style=color:#57606a># and more ...</span>
</span></span><span style=display:flex><span>    ORANGE <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[33m&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#1f2328>}</span><span style=color:#0550ae>.</span>get<span style=color:#1f2328>(</span>color<span style=color:#1f2328>,</span> <span style=color:#0a3069>&#34;&#34;</span><span style=color:#1f2328>)</span>
</span></span></code></pre></div><p>The trick is, the dictionary&rsquo;s built in <code>get</code> method. The first parameter here is key, the second optional parameter is default. As the docstring shows:</p><blockquote><p>D.get(k[,d]) -> D[k] if k in D, else d. d defaults to None.</p></blockquote><h2 id=use-the-decorator>Use the decorator</h2><p>Suppose we have a function to implement a task. It may has three kind of return string, if task is completed successfully, it returns &ldquo;SUCCESS: blah blah &mldr;&rdquo;, if the task is finished but we cannot ensure it&rsquo;s corretness, it returns &ldquo;WARNING: blah blah &mldr;&rdquo;, if task failed, returns &ldquo;ERROR: blah blah &mldr;&rdquo;, how do we colorize these return strings?</p><p><a href=https://gist.github.com/Wilbeibi/a2ac59f211bcd681d007>Raw code</a></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#cf222e>def</span> <span style=color:#6639ba>colorize</span><span style=color:#1f2328>(</span><span style=color:#0550ae>*</span>args<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>def</span> <span style=color:#6639ba>getColor</span><span style=color:#1f2328>(</span>color<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>        <span style=color:#cf222e>return</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>            <span style=color:#0a3069>&#39;black&#39;</span> <span style=color:#1f2328>:</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[30m&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>            <span style=color:#0a3069>&#39;red&#39;</span> <span style=color:#1f2328>:</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[31m&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>            <span style=color:#0a3069>&#39;green&#39;</span> <span style=color:#1f2328>:</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[32m&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>            <span style=color:#0a3069>&#39;orange&#39;</span> <span style=color:#1f2328>:</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[33m&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>            <span style=color:#0a3069>&#39;blue&#39;</span> <span style=color:#1f2328>:</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[34m&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>            <span style=color:#0a3069>&#39;purple&#39;</span> <span style=color:#1f2328>:</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[35m&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>            <span style=color:#0a3069>&#39;cyan&#39;</span> <span style=color:#1f2328>:</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[36m&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>            <span style=color:#0a3069>&#39;light_grey&#39;</span> <span style=color:#1f2328>:</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[37m&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#1f2328>}</span><span style=color:#0550ae>.</span>get<span style=color:#1f2328>(</span>color<span style=color:#1f2328>,</span> <span style=color:#0a3069>&#34;&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>def</span> <span style=color:#6639ba>_colorize</span><span style=color:#1f2328>():</span>
</span></span><span style=display:flex><span>        <span style=color:#cf222e>def</span> <span style=color:#6639ba>wrapper</span><span style=color:#1f2328>():</span>
</span></span><span style=display:flex><span>            RESET <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#39;</span><span style=color:#0a3069>\033</span><span style=color:#0a3069>[0m&#39;</span>
</span></span><span style=display:flex><span>            text <span style=color:#0550ae>=</span> func<span style=color:#1f2328>()</span>
</span></span><span style=display:flex><span>            <span style=color:#57606a>#if not isinstance(text, basestring):</span>
</span></span><span style=display:flex><span>            <span style=color:#57606a>#    text = str(text)</span>
</span></span><span style=display:flex><span>            level <span style=color:#0550ae>=</span> text<span style=color:#0550ae>.</span>split<span style=color:#1f2328>(</span><span style=color:#0a3069>&#39;:&#39;</span><span style=color:#1f2328>,</span> <span style=color:#0550ae>1</span><span style=color:#1f2328>)[</span><span style=color:#0550ae>0</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>            color <span style=color:#0550ae>=</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#39;SUCCESS&#39;</span><span style=color:#1f2328>:</span> args<span style=color:#1f2328>[</span><span style=color:#0550ae>0</span><span style=color:#1f2328>],</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#39;WARNING&#39;</span><span style=color:#1f2328>:</span> args<span style=color:#1f2328>[</span><span style=color:#0550ae>1</span><span style=color:#1f2328>],</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#39;ERROR&#39;</span><span style=color:#1f2328>:</span> args<span style=color:#1f2328>[</span><span style=color:#0550ae>2</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>            <span style=color:#1f2328>}</span><span style=color:#0550ae>.</span>get<span style=color:#1f2328>(</span>level<span style=color:#1f2328>,</span> <span style=color:#0a3069>&#39;&#39;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>            <span style=color:#cf222e>return</span> <span style=color:#0a3069>&#34;</span><span style=color:#0a3069>{0}{1}{2}</span><span style=color:#0a3069>&#34;</span><span style=color:#0550ae>.</span>format<span style=color:#1f2328>(</span>getColor<span style=color:#1f2328>(</span>color<span style=color:#1f2328>),</span> text<span style=color:#1f2328>,</span> RESET<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        <span style=color:#cf222e>return</span> wrapper
</span></span><span style=display:flex><span>    <span style=color:#cf222e>return</span> _colorize
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#0550ae>@colorize</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;green&#34;</span><span style=color:#1f2328>,</span> <span style=color:#0a3069>&#34;orange&#34;</span><span style=color:#1f2328>,</span> <span style=color:#0a3069>&#34;red&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span><span style=color:#cf222e>def</span> <span style=color:#6639ba>do_task</span><span style=color:#1f2328>():</span>
</span></span><span style=display:flex><span>    <span style=color:#57606a># working working ....</span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>if</span> <span style=color:#1f2328>(</span>success<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>        <span style=color:#cf222e>return</span> <span style=color:#0a3069>&#34;SUCCESS: Yeah~~&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>elif</span> <span style=color:#1f2328>(</span>warning<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>        <span style=color:#cf222e>return</span> <span style=color:#0a3069>&#34;WARNING: wait, what?&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>else</span><span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span>        <span style=color:#cf222e>return</span> <span style=color:#0a3069>&#34;ERROR: something went wrong here.&#34;</span>
</span></span></code></pre></div><p>As you can tell, to make the decorator with parameters, we need to put it in another decorator.</p><p>Decorator are often used as cache, profiler, logger, synchronization(acquire lock, drop lock) and so forth. One of my favourite library <a href=http://click.pocoo.org/3/>Click</a> is also a wonderful example.</p><p>Happy Chinese New Year ~</p><div class=post-tags><a href=https://wilbeibi.com/tags/python/>python</a></div></div><div class=footer><p>Design by <a href=https://github.com/mitsuhiko/lucumr>Armin Ronacher</a>.</p><p>Subscribe via <a href=https://wilbeibi.com/index.xml>RSS</a>.</p></div></div></body></html>